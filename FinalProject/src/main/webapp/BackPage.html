<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
	integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
	crossorigin="anonymous">
<link rel="stylesheet" href="css/fp.css">
<link rel="stylesheet"
	href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
	<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script type="text/javascript" src="/js/flot/jquery.flot.min.js"></script>    
    <script type="text/javascript" src="/js/flot/jquery.flot.symbol.js"></script>
    <script type="text/javascript" src="/js/flot/jquery.flot.axislabels.js"></script>
	<script type="text/javascript" src="js/flot/jquery.js"></script>
	<script type="text/javascript" src="js/flot/jquery.flot.js"></script>
<script type="text/javascript"
	src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script type="text/javascript"
	src="http://www.pureexample.com/js/lib/jquery.ui.touch-punch.min.js"></script>
<script src="js/basic.js"></script>
<script src="js/backpage.js"></script>
<script src="js/crawler.js"></script>
<title>後台</title>
<style>
a {
	color: rgb(85, 73, 73);
	font-size: 24px;
	font-family: "微軟正黑體"
}

tr td {
	border: 1px solid black;
	width: 70px;
}

.mytable {
	width: 50%;
	max-width: 100%;
	margin: 1rem auto;
	background-color: transparent;
}

.mytable tbody tr td {
	width: 500px;
}
</style>

</head>

<body>
	<header style="width: 100%">
		<div style="align-items: baseline;"
			class="d-flex justify-content-between">
			<div class="navv" style="width: 80%">
				<ul class="nav nav-pills nav-fill">
					<!-- <li class="nav-item">
                              <a class="nav-link" href="#"><img src="image/001.png" width="50px"></a>
                            </li> -->
					<li class="nav-item"><a class="nav-link" href="#"
						onclick='click1("#pagestyle")'>畫面/商品管理</a></li>
					<li class="nav-item"><a class="nav-link" href="#">會員管理</a></li>
					<li class="nav-item"><a class="nav-link" href="#">訂單管理</a></li>
					<li class="nav-item"><a class="nav-link" href="#"
						onclick='click1("#chartpage")'>分析圖表</a></li>
					<li class="nav-item"><a class="nav-link" href="#"
						onclick='click1("#bugpage")'>爬蟲分析</a></li>
				</ul>
			</div>
			<div class="navv">
				<ul>
					<li><a href="" data-toggle="modal"
						data-target="#exampleModalCenter"> <img
							src="image/envelope.png" width="30px">
					</a></li>
					<li><a id="test" href=""> <img src="image/cat.png"
							width="30px">
					</a></li>
				</ul>
				<fieldset id="myModal" class="mymodal">
					<div class="dropdown-divider"></div>
					<a href='FirstPage.html'>
						<button style="width: 300px" class='btn btn-dark'>登出</button>
					</a>
				</fieldset>
			</div>
		</div>

	</header>
	<article>
		<!-----------------------------------------------畫面調整畫面----------------------------------------------- -->
		<div id="pagestyle"
			style="margin-top: 50px; flex-wrap: wrap; display: inline-flex; width: 100%;">
			<div style="width: 80%; align-items: flex-start;">
				<iframe style="border: none; height: 800px; width: 100%"
					src="FirstPage.html" width="100%"></iframe>
			</div>
			<div style="width: 20%; align-items: flex-start;">
				<div
					style="background: whitesmoke; width: 100%; border: 1px solid grey; height: 800px;">
					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<h6 id="area1"></h6>
					</div>
					<div style="overflow: scroll; height: 350px; width: 100%">
						<ol class="forinput" style="btext-align: center;"
							id="fordatainput">
						</ol>
					</div>
					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<h6 id="area2"></h6>
					</div>
					<div style="overflow: scroll; height: 350px;">

						<ol class="forinput" style="btext-align: center; width: 100%"
							id="fordatainput2">

						</ol>
					</div>
					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<button style="display: none" id="changemodel" data-toggle="modal"
							data-target="#foradd" class="btn btn-secondary">Add</button>
						<button style="display: none" id="changemodel2"
							data-toggle="modal" data-target="#foradd2"
							class="btn btn-secondary">Add</button>
						<button style="display: none" id="forremove"
							class="btn btn-secondary">Remove</button>
						<button style="display: none" id="forremove2"
							class="btn btn-secondary">Remove</button>
					</div>
				</div>
			</div>
		</div>

		<!-- 		-----modal----------------------------------------------- -->
		<div class="modal fade" id="foradd" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalCenterTitle">上傳圖片</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form>
						<div class="modal-body">
							<input type="file" id="uploadfile">
							<div id="showphoto"></div>
						</div>
						<div class="modal-footer">
							<button type="reset" class="btn btn-primary" id="foraddbtn">上傳</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="modal fade" id="foradd2" tabindex="-1" role="dialog"
			aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalCenterTitle">選擇欲上架商品</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<form>
						<div class="modal-body">
							<select id="select1">
							</select>
							<div id="showphoto2"></div>
						</div>
						<div class="modal-footer">
							<button type="reset" class="btn btn-primary" id="foraddbtn2">上架</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<!-- 	---------------爬蟲分析畫面---------------------------------------------------------------------->
		<div id="bugpage"
			style="margin-top: 50px; flex-wrap: wrap; display: inline-flex; width: 100%;">
			<div
				style="width: 80%; height: 800px; align-items: flex-start; overflow: scroll;">

			</div>
			<div style="width: 20%; align-items: flex-start;">
				<div
					style="background: whitesmoke; width: 100%; border: 1px solid grey; height: 800px;">
					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<h6 id="area2">選擇網站</h6>
						<select id="selectbug2">
							<option value="meow">請選擇網站</option>
							<option value="http://www.gh3c.com.tw/">光華商場</option>
						</select> <select id="selectbug3">
						</select><br>
						<button class="btn btn-secondary">爬取商品資訊</button>
					</div>

					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<h6 id="area1">選擇型號</h6>
						<select id="selectbug1">
						</select><br>
						<button class="btn btn-secondary">單一商品比較</button>
					</div>
					<div id="showpro" style="width: 100%; padding: 10px 60px"></div>

				</div>
			</div>
		</div>
		<!-- 	---------------分析圖表畫面---------------------------------------------------------------------->
		<div id="chartpage"
			style="margin-top: 50px; flex-wrap: wrap; display: inline-flex; width: 100%;">
			<div
				style="width: 80%; height: 800px; align-items: flex-start; overflow: scroll;">
				<div id="flot-placeholder" style="width: 1000px; height: 500px;margin:50px auto;"></div>
                <div></div>
			</div>
			<div style="width: 20%; align-items: flex-start;">
				<div
					style="background: whitesmoke; width: 100%; border: 1px solid grey; height: 800px;">
					<div
						style="background: aliceblue; text-align: center; padding: 10px">
						<h6 id="area2">分析圖表</h6>
						<select id="chartselect">
							<option value="meow">------</option>
							<option value="">銷售圖表</option>
						</select><br>
						<button class="btn btn-secondary">產生圖表</button>
					</div>
				</div>
			</div>
		</div>



	</article>

	<script>
		$("#chartselect").next().next().click(function(){
			$.post("ChartSelect", function(data, status) {
				if (status == "success") {
					var datata = [];
					var ticks = [];
					var query = $.parseJSON(data)
					var count = 0;
					var str= '<table class="mytable table-striped">';
					str +='<thead><tr><th scope="col">#</th><th scope="col">商品型號</th><th scope="col">商品數量</th></tr></thead><tbody>'
					$.each(query, function(index, json) {
                        var ele = new Array(count, json.sum);
						datata[index] = ele;
						var ele2 = new Array(count, json.pro.model);
						ticks[index] = ele2
						str += '<tr><td>' + (count+1) + '</td><td>' + json.pro.model +'</td><td>' + json.sum +'</td></tr>'
						count++;
					})
                    str += '</tbody></table>'
                    
					var dataset = [ {
						label : "數量",
						data : datata,
						color : "grey"
					} ];
			var options = {
				series : {
					bars : {
						show : true
					}
				},
				bars : {
					align : "center",
					barWidth : 0.1
				},
				xaxis : {
					axisLabel : "商品型號",
					axisLabelUseCanvas : true,
					axisLabelFontSizePixels : 12,
					axisLabelFontFamily : '微軟正黑體',
					axisLabelPadding : 20,
					ticks : ticks
				},
				yaxis : {
					axisLabel : "數量",
					axisLabelUseCanvas : true,
					axisLabelFontSizePixels : 12,
					axisLabelFontFamily : '微軟正黑體',
					axisLabelPadding : 3,
					tickFormatter : function(v, axis) {
						return v + "個";
					}
				},
				legend : {
					noColumns : 0,
					labelBoxBorderColor : "#000000",
					position : "nw"
				},
				grid : {
					hoverable : true,
					borderWidth : 2,
					backgroundColor : {
						colors : [ "#ffffff", "#EDF5FF" ]
					}
				}
			};
			$.plot($("#flot-placeholder"), dataset, options);
			   $("#flot-placeholder").next().html(str)
			   $("#flot-placeholder").UseTooltip();
				
				}
			})


		});
		
		   
		   function gd(year, month, day) {
	            return new Date(year, month, day).getTime();
	        }
	 
	        var previousPoint = null, previousLabel = null;
	 
	        $.fn.UseTooltip = function () {
	            $(this).bind("plothover", function (event, pos, item) {
	                if (item) {
	                    if ((previousLabel != item.series.label) || (previousPoint != item.dataIndex)) {
	                        previousPoint = item.dataIndex;
	                        previousLabel = item.series.label;
	                        $("#tooltip").remove();
	 
	                        var x = item.datapoint[0];
	                        var y = item.datapoint[1];
	 
	                        var color = item.series.color;
	 
	                        //console.log(item.series.xaxis.ticks[x].label);                
	 
	                        showTooltip(item.pageX,
	                        item.pageY,
	                        color,
	                        "<strong>" + item.series.label + "</strong><br>" + item.series.xaxis.ticks[x].label + " : <strong>" + y + "</strong> 個");
	                    }
	                } else {
	                    $("#tooltip").remove();
	                    previousPoint = null;
	                }
	            });
	        };
	 
	        function showTooltip(x, y, color, contents) {
	            $('<div id="tooltip">' + contents + '</div>').css({
	                position: 'absolute',
	                display: 'none',
	                top: y - 40,
	                left: x - 120,
	                border: '2px solid ' + color,
	                padding: '3px',
	                'font-size': '9px',
	                'border-radius': '5px',
	                'background-color': '#fff',
	                'font-family': '微軟正黑體',
	                opacity: 0.9
	            }).appendTo("body").fadeIn(200);
	        }
		  

	</script>

	<script
		src="https://cdn.jsdelivr.net/jquery.webui-popover/1.2.1/jquery.webui-popover.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
		integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
		crossorigin="anonymous"></script>

	<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
		integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
		crossorigin="anonymous"></script>
</body>

</html>